import spacy
from transformers import pipeline
from nltk import word_tokenize, pos_tag, ne_chunk
from nltk.tree import Tree
import stanza
import nltk
nltk.download('punkt')
nltk.download('averaged_perceptron_tagger')
nltk.download('maxent_ne_chunker')
nltk.download('maxent_ne_chunker_tab')
nltk.download('words')
nltk.download('averaged_perceptron_tagger_eng')
stanza.download('en')
stanza.download('ru')
nlp_en = spacy.load("en_core_web_sm")
nlp_ru = spacy.load("ru_core_news_sm")
nlp_multi = spacy.load("xx_ent_wiki_sm")

hf_ner = pipeline("ner", model="dslim/bert-base-NER")

def nltk_ner(text):
    tokens = word_tokenize(text)
    pos_tags = pos_tag(tokens)
    chunks = ne_chunk(pos_tags)
    entities = []
    for chunk in chunks:
        if isinstance(chunk, Tree):
            entity_name = " ".join(c[0] for c in chunk)
            entity_type = chunk.label()
            entities.append((entity_name, entity_type))
    return entities

stanza.download("en")
stanza.download("ru")
nlp_stanza = stanza.Pipeline(lang='en', processors='tokenize,ner')

text_en = "Barack Obama was the 44th president of the United States."
text_ru = "В отзыве нужно поставить звезды за долговечность. Это можно сделать только через несколько лет использования.пылесос оправдал все ожидания: компактный, стильно выглядит, удобен и прост в эксплуатации. щетки хорошо справляются с въевшейся грязью. удобная система сбора пыли и простой уход за самим пылесосом. особенно необходим в доме с домашними животными. помимо очистки еще и увлажнит воздух-многофункциональность Для дома пойдет, стачивал заусенцы в коробке мотоблока на шестерне, не разбирая Рекомендую к приобретению Нормальный инструмент. Для новичка самое оно. Для профи наверное будет не очень. В принципе за свои деньги пойдет. Пару раз очень пригодился. До этого раз в руках держал ""Dremel"" там биение конечно же отсутствовало, но и цена несоизмерима. Цена соответствует качеству Надеюсь, 2 понедельника протянет. Использую не один год. Никогда не подводил. За свою цену норм, для базовых не прецизионных задач годится. Гибкий вал можно использовать, но предварительно лучше смазать консистентной смазкой, хотя сильную вибрацию и нагрев это не исключит. В целом инструмент хороший, но опять же за свою цену. Главным минусом являются: конкретно у меня - слизанная резьба на конце шпинделя, а также особенность модели, сложное позиционирование насадок в цанге. Нужно очень долго настраиваться чтобы избежать биения. Для полировки не так критично, но если сверлить, думаю, проблемы будут. Сам сверлить пока не пробовал. Брал для полировки листа металла от окалины. С задачей справился, но биение порой приводило к неравномерности полировки. Купил и поленился проверить в центре днс ,приехал домой распаковал, подключил и тишина(не рабочий попался ) пришлось ехать делать обмен!проверяйте в магазине дабы не тратить время по возврату. Покупался для конкретной задачи. Было необходимо вырезать отверстия в толстом пластике дверных карт автомобиля и вырезать метал внутри двери. В целом инструмент с задачей справился. Однако, поддать бы ему мощности. Особенно когда работаешь с гибким валом. Стоит чуть больше придавить, и насадка сразу вязнет, моторчик захлёбывается. При использовании показалось, что довольно быстро начинает греться, потому почаще давал остыть, чтоб не спалить. За свои деньги хорошие инструмент Купил ее в связи с обменом шлефмашинки по гарантии при этом доплатив тысячу рублей.  Прям очень понравился этот набор, в комплектации большое количество различных насадок, удлинитель для них же, регулировка скорости оборотов, кейс. Я очень доволен. В бережных руках и работать будет дольше.Нужно быть очень осторожным при больших оборотах и острыми лезвиями иначе может соскочить из рук и поранить. Ни сколько не пожалел. Рекомендую! Если нужен максимально точное выполнение работ, посмотрите другие модели по дороже. Брал для дома, всё понравилось. Много насадок, удобна в эксплуатации. Мощности хватает. На мой взгляд соотношение цена/качество отличное. Нужно было почистити контакты, да так поделки похожи изобразить плюс в труднодоступных углах зачистить ржавчину, да и так малюсенькие дырки сверлить и полернуть стекляшку. Классная приблуда раньше что не взял жалею много где пригодилась. Бы. Хорошая комплектациях Теперь подробней. Заказал !со склада! запечатанный вариант с доставкой в магазин рядом с домом. В праздничный день Победы пришло уведомление, что товар доставили. Пришёл, не глядя забрал, обычно никогда не было проблем с товарами из ДНС, а покупал я тут много. Но придя домой, обнаружил, что насадки в закрытом, запечатанном пленкой боксе были разбросаны по кейсу. Окей, не беда, распечатал, и сразу вижу, что в кейсе сломано крепление для гравера, а я его всего лишь открыл, даже не доставал. Немного расстроился, всё таки новая вещь, должна быть целой. Начал разбирать насадки и оказалось, что одной не хватает. Обыскал весь кейс. Залез даже под кейс (половинка с насадками достается) и нашел! Но не недостающую насадку, а кусок сломанного прозрачного пластика, причем не от этого кейса. По итогу кейс хоть и запечатан в пленочку и так далее, имеет кучу трещин, не полная комплектация, да еще и крепления сломаны. "

doc_en = nlp_en(text_en)
doc_ru = nlp_ru(text_ru)
print("SpaCy (EN):", [(ent.text, ent.label_) for ent in doc_en.ents])
print("SpaCy (RU):", [(ent.text, ent.label_) for ent in doc_ru.ents])

hf_entities = hf_ner(text_en)
print("Hugging Face:", hf_entities)

nltk_entities = nltk_ner(text_en)
print("NLTK:", nltk_entities)

doc_stanza = nlp_stanza(text_en)
print("Stanford NER:", [(ent.text, ent.type) for ent in doc_stanza.ents])

